const { chromium } = require('playwright'), fs = require('fs'), HTMLParser = require('node-html-parser');

senderNames = [];
senderEmails = [];
recipientNames = [];
recipientEmails = [];

(async () => {
    for(let i = 1; i < 36; i++) {
        const d = HTMLParser.parse(fs.readFileSync(`recipient/p${i}.html`, 'utf8'));
        const names = d.querySelectorAll('.box-member__title');
        for(let j = 0; j < names.length; j++)
            recipientNames.push(names[j].firstChild._rawText);
        const emails = d.querySelectorAll('.icon-text-sidebar__content.link-has-underline.list-in-article.typography-space-small');
        for(let j = 0; j < emails.length; j++)
            if(emails[j].firstChild && emails[j].firstChild._rawText.includes("@ohs.stanford.edu"))
                recipientEmails.push(emails[j].firstChild._rawText);
    }
    for(let i = 1; i < 8; i++) {
        const d = HTMLParser.parse(fs.readFileSync(`sender/p${i}.html`, 'utf8'));
        const names = d.querySelectorAll('.box-member__title');
        for(let j = 0; j < names.length; j++)
            senderNames.push(names[j].firstChild._rawText);
        const emails = d.querySelectorAll('.icon-text-sidebar__content.link-has-underline.list-in-article.typography-space-small');
        for(let j = 0; j < emails.length; j++)
            if(emails[j].firstChild && emails[j].firstChild._rawText.includes("@ohs.stanford.edu"))
                senderEmails.push(emails[j].firstChild._rawText);
    }

    console.log(senderNames.length, senderEmails.length, recipientNames.length, recipientEmails.length);

    const browser = await chromium.launch({headless: false});
    const context = await browser.newContext();
    while(true) {
        const page = await context.newPage();
        await page.goto('https://stanforduniversity.qualtrics.com/jfe/form/SV_cYfOYqREtprzaia');
        await page.getByText('Your Name').waitFor();

        senderIDX = Math.floor(Math.random()*senderNames.length)
        // await page.waitForTimeout(Math.random()*10000);
        await page.fill('.QR-QID2', senderNames[senderIDX]);
        // await page.waitForTimeout(Math.random()*10000);
        await page.fill('.QR-QID3', senderEmails[senderIDX]);

        // await page.waitForTimeout(Math.random()*10000);
        await page.click('#QID4-4-label')

        recipientIDX = Math.floor(Math.random()*recipientNames.length)
        // await page.waitForTimeout(Math.random()*10000);
        await page.fill('.QR-QID5', recipientNames[recipientIDX]);
        // await page.waitForTimeout(Math.random()*10000);
        await page.fill('.QR-QID6', recipientEmails[recipientIDX]);
        
        const possibleMessages = [ `${recipientNames[recipientIDX]}, you're an awesome friend.`, `${recipientNames[recipientIDX]}, you're a gift to those around you.`, `${recipientNames[recipientIDX]}, you're a smart cookie.`, `${recipientNames[recipientIDX]}, you are awesome!`, `${recipientNames[recipientIDX]}, you have impeccable manners.`, `${recipientNames[recipientIDX]}, I like your style.`, `${recipientNames[recipientIDX]}, you have the best laugh.`, `${recipientNames[recipientIDX]}, I appreciate you.`, `${recipientNames[recipientIDX]}, you are the most perfect you there is.`, `${recipientNames[recipientIDX]}, you are enough.`, `${recipientNames[recipientIDX]}, you're strong.`, `${recipientNames[recipientIDX]}, your perspective is refreshing.`, `${recipientNames[recipientIDX]}, you're an amazing listener.`, `${recipientNames[recipientIDX]}, you light up the room.`, `${recipientNames[recipientIDX]}, your kindness is a balm to all who encounter it.`, `${recipientNames[recipientIDX]}, you're all that and a super-size bag of chips.`, `${recipientNames[recipientIDX]}, on a scale from 1 to 10, you're an 11.`, `${recipientNames[recipientIDX]}, you are brave.`, `${recipientNames[recipientIDX]}, you have the courage of your convictions.`, `${recipientNames[recipientIDX]}, your eyes are breathtaking.`, `${recipientNames[recipientIDX]}, if cartoon bluebirds were real, a bunch of them would be sitting on your shoulders singing right now.`, `${recipientNames[recipientIDX]}, you are making a difference.`, `${recipientNames[recipientIDX]}, you're like sunshine on a rainy day.`, `${recipientNames[recipientIDX]}, you bring out the best in other people.`, `${recipientNames[recipientIDX]}, your ability to recall random factoids at just the right time is impressive.`, `${recipientNames[recipientIDX]}, you're a great listener.`, `${recipientNames[recipientIDX]}, everything would be better if more people were like you!`, `${recipientNames[recipientIDX]}, I bet you sweat glitter.`, `${recipientNames[recipientIDX]}, you were cool way before hipsters were cool.`, `${recipientNames[recipientIDX]}, that color is perfect on you.`, `${recipientNames[recipientIDX]}, hanging out with you is always a blast.`, `${recipientNames[recipientIDX]}, you always know -- and say -- exactly what I need to hear when I need to hear it.`, `Hope you're having a great day, ${recipientNames[recipientIDX]}!`, `Just wanted to drop by and say hi, ${recipientNames[recipientIDX]}.`, `Thinking of you, ${recipientNames[recipientIDX]}.`, `Sending positive vibes your way, ${recipientNames[recipientIDX]}.`, `Wishing you a wonderful week, ${recipientNames[recipientIDX]}.`, `You're doing great, ${recipientNames[recipientIDX]}! Keep it up.`, `Hope you're taking care of yourself, ${recipientNames[recipientIDX]}.`, `Stay strong, ${recipientNames[recipientIDX]}. You got this.`, `Remember to take breaks and relax, ${recipientNames[recipientIDX]}.`, `You're such an inspiration, ${recipientNames[recipientIDX]}.`, `Sending you a virtual hug, ${recipientNames[recipientIDX]}.`, `Keep pushing forward, ${recipientNames[recipientIDX]}.`, `You're not alone, ${recipientNames[recipientIDX]}. I'm here for you.`, `You're a rockstar, ${recipientNames[recipientIDX]}.`, `I believe in you, ${recipientNames[recipientIDX]}.`, `Hope your day is as amazing as you are, ${recipientNames[recipientIDX]}.`, `Don't forget to treat yourself today, ${recipientNames[recipientIDX]}.`, `You're making progress, ${recipientNames[recipientIDX]}. Keep it up!`, `Thanks for being awesome, ${recipientNames[recipientIDX]}.`, `You're a ray of sunshine, ${recipientNames[recipientIDX]}.`, `Have a fantastic day, ${recipientNames[recipientIDX]}.`, `I'm grateful to know you, ${recipientNames[recipientIDX]}.`, `You're capable of amazing things, ${recipientNames[recipientIDX]}.`, `You're making a difference, ${recipientNames[recipientIDX]}.`, `I appreciate you, ${recipientNames[recipientIDX]}.`, `Keep shining bright, ${recipientNames[recipientIDX]}.`, `You're one of a kind, ${recipientNames[recipientIDX]}.`, `You're doing great things, ${recipientNames[recipientIDX]}.`, `Hope your day is full of joy and laughter, ${recipientNames[recipientIDX]}.`, `Thank you for being a friend, ${recipientNames[recipientIDX]}.`, `You inspire me, ${recipientNames[recipientIDX]}.`, `Sending you positive energy, ${recipientNames[recipientIDX]}.`, `Hope you have a wonderful weekend, ${recipientNames[recipientIDX]}.`, `You deserve all the happiness in the world, ${recipientNames[recipientIDX]}.`, `You're a true gem, ${recipientNames[recipientIDX]}.`, `You're amazing just the way you are, ${recipientNames[recipientIDX]}.`, `Thanks for being a great listener, ${recipientNames[recipientIDX]}.`, `You're a true friend, ${recipientNames[recipientIDX]}.`, `Keep being your awesome self, ${recipientNames[recipientIDX]}.`, `You're making a positive impact, ${recipientNames[recipientIDX]}.`, `Hope you're taking time to relax and unwind, ${recipientNames[recipientIDX]}.`, `You're so talented, ${recipientNames[recipientIDX]}.`, `Thank you for being you, ${recipientNames[recipientIDX]}.`, `You're a true blessing, ${recipientNames[recipientIDX]}.`, `Don't give up, ${recipientNames[recipientIDX]}. You've got this!`, `You're an important part of my life, ${recipientNames[recipientIDX]}.`, `Hope you know how much you're loved, ${recipientNames[recipientIDX]}.`, `You have a heart of gold, ${recipientNames[recipientIDX]}.`, `Thanks for being a source of positivity, ${recipientNames[recipientIDX]}.`, `You're a true gift, ${recipientNames[recipientIDX]}.`, `Keep spreading kindness, ${recipientNames[recipientIDX]}.`, `You're a superstar, ${recipientNames[recipientIDX]}.`, `You're making the world a better place, ${recipientNames[recipientIDX]}.`, `Hope you have a relaxing evening, ${recipientNames[recipientIDX]}.`, `You're so talented and creative, ${recipientNames[recipientIDX]}.`, `Thank you for being a constant support, ${recipientNames[recipientIDX]}.`, `You're such a kind and caring person, ${recipientNames[recipientIDX]}.`, `Hey ${recipientNames[recipientIDX]}, hope you're having a great day!`, `Just wanted to check in and say hi, ${recipientNames[recipientIDX]}.`, `I appreciate your friendship, ${recipientNames[recipientIDX]}.`, `Thanks for always being there for me, ${recipientNames[recipientIDX]}.`, `You're a great listener, ${recipientNames[recipientIDX]}.`, `Hope you're staying safe and healthy, ${recipientNames[recipientIDX]}.`, `Sending positive vibes your way, ${recipientNames[recipientIDX]}.`, `I'm grateful to have you in my life, ${recipientNames[recipientIDX]}.`, `Thinking of you today, ${recipientNames[recipientIDX]}.`, `Wishing you a wonderful week, ${recipientNames[recipientIDX]}.`, `Hope your day is going well, ${recipientNames[recipientIDX]}.`, `Thanks for making me laugh, ${recipientNames[recipientIDX]}.`, `You're such a kind person, ${recipientNames[recipientIDX]}.`, `Your hard work is paying off, ${recipientNames[recipientIDX]}.`, `You inspire me, ${recipientNames[recipientIDX]}.`, `Keep up the great work, ${recipientNames[recipientIDX]}.`, `You're doing an amazing job, ${recipientNames[recipientIDX]}.`, `I'm proud of you, ${recipientNames[recipientIDX]}.`, `You're an important part of my life, ${recipientNames[recipientIDX]}.`, `Thanks for being a great friend, ${recipientNames[recipientIDX]}.`, `You're so talented, ${recipientNames[recipientIDX]}.`, `I admire your perseverance, ${recipientNames[recipientIDX]}.`, `Hope you have a restful weekend, ${recipientNames[recipientIDX]}.`, `I appreciate your honesty, ${recipientNames[recipientIDX]}.`, `You're a great role model, ${recipientNames[recipientIDX]}.`, `Keep pushing yourself, ${recipientNames[recipientIDX]}.`, `You're making a difference, ${recipientNames[recipientIDX]}.`, `I'm rooting for you, ${recipientNames[recipientIDX]}.`, `Don't give up, ${recipientNames[recipientIDX]}.`, `Your positivity is contagious, ${recipientNames[recipientIDX]}.`, `Thanks for being you, ${recipientNames[recipientIDX]}.`, `I'm lucky to have you as a friend, ${recipientNames[recipientIDX]}.`, `You're always so helpful, ${recipientNames[recipientIDX]}.`, `I'm grateful for your support, ${recipientNames[recipientIDX]}.`, `You're one of a kind, ${recipientNames[recipientIDX]}.`, `Hope your day is filled with joy, ${recipientNames[recipientIDX]}.`, `I appreciate your patience, ${recipientNames[recipientIDX]}.`, `You're an asset to our team, ${recipientNames[recipientIDX]}.`, `I'm excited to see what you'll achieve, ${recipientNames[recipientIDX]}.`, `Thanks for being a great listener, ${recipientNames[recipientIDX]}.`, `You're so thoughtful, ${recipientNames[recipientIDX]}.`, `Keep up the good work, ${recipientNames[recipientIDX]}.`, `You're a valuable member of our community, ${recipientNames[recipientIDX]}.`, `Hey ${recipientNames[recipientIDX]}, just wanted to say hello!`, `Hope you're doing well today, ${recipientNames[recipientIDX]}!`, `Sending positive vibes your way, ${recipientNames[recipientIDX]}.`, `Thinking of you, ${recipientNames[recipientIDX]}!`, `Wishing you a wonderful day, ${recipientNames[recipientIDX]}.`, `Just wanted to let you know how much I appreciate you, ${recipientNames[recipientIDX]}.`, `You're awesome, ${recipientNames[recipientIDX]}!`, `Hope your day is as amazing as you are, ${recipientNames[recipientIDX]}.`, `Just wanted to remind you that you're amazing, ${recipientNames[recipientIDX]}.`, `You're one of the coolest people I know, ${recipientNames[recipientIDX]}.`, `Sending you a virtual high-five, ${recipientNames[recipientIDX]}!`, `Thanks for being such a great friend, ${recipientNames[recipientIDX]}.`, `You always know how to make me laugh, ${recipientNames[recipientIDX]}.`, `I'm grateful to have you in my life, ${recipientNames[recipientIDX]}.`, `Keep being your amazing self, ${recipientNames[recipientIDX]}.`, `You inspire me, ${recipientNames[recipientIDX]}.`, `I appreciate your kindness, ${recipientNames[recipientIDX]}.`, `You're a ray of sunshine, ${recipientNames[recipientIDX]}.`, `Thanks for being you, ${recipientNames[recipientIDX]}.`, `You're a wonderful person, ${recipientNames[recipientIDX]}.`, `Hope your day is filled with laughter and joy, ${recipientNames[recipientIDX]}.`, `Thinking of you and sending positive thoughts your way, ${recipientNames[recipientIDX]}.`, `Thanks for being an amazing co-worker, ${recipientNames[recipientIDX]}.`, `You make the world a better place, ${recipientNames[recipientIDX]}.`, `Thanks for always being there for me, ${recipientNames[recipientIDX]}.`, `You have a heart of gold, ${recipientNames[recipientIDX]}.`, `Wishing you all the happiness in the world, ${recipientNames[recipientIDX]}.`, `You're a superstar, ${recipientNames[recipientIDX]}.`, `Thanks for making me smile, ${recipientNames[recipientIDX]}.`, `You're one of a kind, ${recipientNames[recipientIDX]}.`, `Thanks for being a great listener, ${recipientNames[recipientIDX]}.`, `You're a true friend, ${recipientNames[recipientIDX]}.`, `Hope your day is filled with love, ${recipientNames[recipientIDX]}.`, `Thanks for being a great team player, ${recipientNames[recipientIDX]}.`, `You're amazing just the way you are, ${recipientNames[recipientIDX]}.`, `Thanks for being so supportive, ${recipientNames[recipientIDX]}.`, `You're a wonderful parent, ${recipientNames[recipientIDX]}.`, `Thanks for always being honest, ${recipientNames[recipientIDX]}.`, `You're a great example to others, ${recipientNames[recipientIDX]}.`, `Thanks for being an amazing mentor, ${recipientNames[recipientIDX]}.`, `You have a heart of compassion, ${recipientNames[recipientIDX]}.`, `Thanks for being so understanding, ${recipientNames[recipientIDX]}.`, `You're an inspiration to many, ${recipientNames[recipientIDX]}.`, `Thanks for being such a hard worker, ${recipientNames[recipientIDX]}.`, `You have a great sense of humor, ${recipientNames[recipientIDX]}.`, `Thanks for being so patient, ${recipientNames[recipientIDX]}.`, `You have a gift for making others feel special, ${recipientNames[recipientIDX]}.`, `Thanks for being so kind-hearted, ${recipientNames[recipientIDX]}.`, `You're a great role model, ${recipientNames[recipientIDX]}.`, `Thanks for always being reliable, ${recipientNames[recipientIDX]}.`, `You're a true gem, ${recipientNames[recipientIDX]}.`, `Thanks for being so generous, ${recipientNames[recipientIDX]}.`, `You have a talent for making the world a better place, ${recipientNames[recipientIDX]}.`, `Thanks for being so positive, ${recipientNames[recipientIDX]}.`, `You're an amazing artist, ${recipientNames[recipientIDX]}.`, `Hope you're having a great day, ${recipientNames[recipientIDX]}!`, `Just wanted to say hello, ${recipientNames[recipientIDX]}!`, `Thinking of you, ${recipientNames[recipientIDX]}.`, `Sending positive vibes your way, ${recipientNames[recipientIDX]}.`, `Wishing you a wonderful day, ${recipientNames[recipientIDX]}.`, `Hope you're doing well, ${recipientNames[recipientIDX]}.`, `You're doing great, ${recipientNames[recipientIDX]}!`, `I believe in you, ${recipientNames[recipientIDX]}.`, `You've got this, ${recipientNames[recipientIDX]}.`, `Keep up the good work, ${recipientNames[recipientIDX]}.`, `You're amazing, ${recipientNames[recipientIDX]}!`, `Thinking of all the great things you've accomplished, ${recipientNames[recipientIDX]}.`, `Thanks for being such a great friend, ${recipientNames[recipientIDX]}.`, `Hope your day is as amazing as you are, ${recipientNames[recipientIDX]}.`, `Sending love and positivity your way, ${recipientNames[recipientIDX]}.`, `You're a rockstar, ${recipientNames[recipientIDX]}!`, `I appreciate you, ${recipientNames[recipientIDX]}.`, `You inspire me, ${recipientNames[recipientIDX]}.`, `Thanks for being you, ${recipientNames[recipientIDX]}.`, `Hope you're taking care of yourself, ${recipientNames[recipientIDX]}.`, `Keep pushing yourself, ${recipientNames[recipientIDX]}.`, `You're a ray of sunshine, ${recipientNames[recipientIDX]}!`, `You make the world a better place, ${recipientNames[recipientIDX]}.`, `Thanks for being a great listener, ${recipientNames[recipientIDX]}.`, `Hope today is treating you well, ${recipientNames[recipientIDX]}.`, `You're one of a kind, ${recipientNames[recipientIDX]}.`, `I'm grateful for you, ${recipientNames[recipientIDX]}.`, `You're a true gem, ${recipientNames[recipientIDX]}.`, `Keep shining, ${recipientNames[recipientIDX]}.`, `You're an awesome human being, ${recipientNames[recipientIDX]}!`, `Thanks for always being there, ${recipientNames[recipientIDX]}.`, `Hope you're feeling happy and healthy, ${recipientNames[recipientIDX]}.`, `You're making a difference, ${recipientNames[recipientIDX]}.`, `Keep up the good fight, ${recipientNames[recipientIDX]}.`, `You're a superstar, ${recipientNames[recipientIDX]}!`, `Sending hugs your way, ${recipientNames[recipientIDX]}.`, `You're a breath of fresh air, ${recipientNames[recipientIDX]}.`, `Thanks for being so kind, ${recipientNames[recipientIDX]}.`, `Hope your day is filled with joy, ${recipientNames[recipientIDX]}.`, `You're a wonderful person, ${recipientNames[recipientIDX]}.`, `Keep being awesome, ${recipientNames[recipientIDX]}.`, `You're a true friend, ${recipientNames[recipientIDX]}.`, `I'm lucky to know you, ${recipientNames[recipientIDX]}.`, `Hope your day is full of smiles, ${recipientNames[recipientIDX]}.`, `You're an inspiration, ${recipientNames[recipientIDX]}.`, `Thanks for being a positive influence, ${recipientNames[recipientIDX]}.`, `You make the world a brighter place, ${recipientNames[recipientIDX]}.`, `Hope you're enjoying the little things, ${recipientNames[recipientIDX]}.`, `You're a great example to others, ${recipientNames[recipientIDX]}.`, `Keep being you, ${recipientNames[recipientIDX]}.`, `You're a joy to be around, ${recipientNames[recipientIDX]}.`, `Thanks for making me laugh, ${recipientNames[recipientIDX]}.`, `Hope your day is as special as you are, ${recipientNames[recipientIDX]}.`, `You're a beautiful person, ${recipientNames[recipientIDX]}.`, `Keep chasing your dreams, ${recipientNames[recipientIDX]}.`, `You're one of the good ones, ${recipientNames[recipientIDX]}.`, `Thanks for being such a great role model, ${recipientNames[recipientIDX]}.`, `Hope today brings you happiness, ${recipientNames[recipientIDX]}.`, `Hope you're having a good day, ${recipientNames[recipientIDX]}!`, `Just wanted to drop by and say hi, ${recipientNames[recipientIDX]}.`, `Wishing you all the best, ${recipientNames[recipientIDX]}.`, `Stay positive, ${recipientNames[recipientIDX]}!`, `Hope your day is as amazing as you are, ${recipientNames[recipientIDX]}.`, `Sending good vibes your way, ${recipientNames[recipientIDX]}.`, `Remember to take some time for yourself today, ${recipientNames[recipientIDX]}.`, `Just wanted to remind you how awesome you are, ${recipientNames[recipientIDX]}.`, `Keep up the great work, ${recipientNames[recipientIDX]}!`, `Thinking of you today, ${recipientNames[recipientIDX]}.`, `You're doing great, ${recipientNames[recipientIDX]}!`, `Hope today brings you joy, ${recipientNames[recipientIDX]}.`, `Keep pushing through, ${recipientNames[recipientIDX]}!`, `Sending love and positivity to you, ${recipientNames[recipientIDX]}.`, `I'm here for you, ${recipientNames[recipientIDX]}.`, `Hope you have a wonderful week, ${recipientNames[recipientIDX]}.`, `Remember to take things one step at a time, ${recipientNames[recipientIDX]}.`, `Stay strong, ${recipientNames[recipientIDX]}!`, `You got this, ${recipientNames[recipientIDX]}.`, `Wishing you a peaceful day, ${recipientNames[recipientIDX]}.` ]

        // await page.waitForTimeout(Math.random()*10000);
        await page.fill('.QR-QID13', possibleMessages[Math.floor(Math.random()*possibleMessages.length)]);

        // await page.waitForTimeout(Math.random()*10000);
        // await page.getByLabel("Next").click();
        // await page.waitForTimeout(Math.random()*10000);
    }

    await context.close();
    await browser.close();
})()